# Anisotropic Extension of the Exchange Factor Transformation

## Introduction

The exchange factor transformation described in Chapter @sec-exchange_fact_trans enables analytical treatment of multiple reflection-scattering processes in radiative transfer by transforming the exchange factor matrix $\mathbf{F}$ into absorption and reflection-scattering matrices $\mathbf{A}$ and $\mathbf{R}$. The method assumes isotropic reflection-scattering behavior, where the probability of reflection-scattering from element $j$ is independent of the incident element $i$. This is represented by a column-constant single reflection-scattering matrix $\mathbf{B}$.

However, many physical systems exhibit anisotropic reflection-scattering, where the probability and directional distribution of reflection-scattering depend on the incident direction. This chapter presents an extension of the exchange factor transformation that accommodates anisotropic reflection-scattering while preserving all fundamental properties: non-negativity, energy conservation, and analytical solvability.

## Anisotropic Reflection-Scattering Matrix

The anisotropic extension introduces a full matrix $\mathbf{\Gamma}$ (Gamma) to characterize directional dependence of reflection-scattering:

$$
\mathbf{\Gamma} \in \mathbb{R}^{N \times N}, \quad 0 \leq \mathbf{\Gamma}_{ij} \leq 1 \quad \forall \; ij
$$ {#eq-gamma-bounds}

where $\mathbf{\Gamma}_{ij}$ represents the anisotropy parameter controlling how incident radiation from element $i$ affects reflection-scattering from element $j$.

### Physical Interpretation

The matrix $\mathbf{\Gamma}$ provides directional control over reflection-scattering behavior:

- $\mathbf{\Gamma}_{ij} = 0.5$: Baseline (isotropic) reflection-scattering from $j$ due to incidence from $i$
- $\mathbf{\Gamma}_{ij} < 0.5$: Reduced reflection-scattering from $j$ due to incidence from $i$ (directional suppression)
- $\mathbf{\Gamma}_{ij} > 0.5$: Enhanced reflection-scattering from $j$ due to incidence from $i$ (directional enhancement)

When $\mathbf{\Gamma}_{ij} = 0.5$ for all elements (or equivalently when the scaling coefficient $c = 0$), the anisotropic formulation reduces exactly to the isotropic case with column-constant reflection-scattering matrix $\mathbf{B}$.

## Construction of the Anisotropic Interaction Matrix

The anisotropic interaction-reflection-scattering matrix $\mathbf{K}$ is constructed through a multi-step process that ensures physical consistency.

**Step 1:** Initial Reflection-Scattering Distribution

Define the initial reflection-scattering distribution matrix:

$$
\mathbf{B}_{\mathrm{init},ij} = \mathbf{b}_j + c(2\mathbf{\Gamma}_{ij} - 1)\min(\mathbf{b}_j, 1-\mathbf{b}_j)
$$ {#eq-b-init}

where:

- $\mathbf{b}_j$ is the baseline reflection-scattering coefficient of element $j$
- $\mathbf{\Gamma}_{ij} \in [0,1]$ controls directional anisotropy
- $c > 0$ is a scaling coefficient that determines the strength of anisotropic perturbations
- $\min(\mathbf{b}_j, 1-\mathbf{b}_j)$ limits the perturbation range to maintain physical validity

This parameterization maps:

- $\mathbf{\Gamma}_{ij} = 0 \rightarrow$ maximum downward perturbation: $\mathbf{B}_{\mathrm{init},ij} = \mathbf{b}_j - c\min(\mathbf{b}_j, 1-\mathbf{b}_j)$
- $\mathbf{\Gamma}_{ij} = 0.5 \rightarrow$ baseline (isotropic): $\mathbf{B}_{\mathrm{init},ij} = \mathbf{b}_j$
- $\mathbf{\Gamma}_{ij} = 1 \rightarrow$ maximum upward perturbation: $\mathbf{B}_{\mathrm{init},ij} = \mathbf{b}_j + c\min(\mathbf{b}_j, 1-\mathbf{b}_j)$

The coefficient $c$ must be chosen to guarantee that the final matrix $\mathbf{K}$ satisfies $0 \leq \mathbf{K}_{ij} \leq \mathbf{F}_{ij}$ for all elements. The maximum safe value $c_{\max}$ can be computed analytically from the constraint equations (see Chapter @sec-exchange_fact_anisotropic_extend_analysis for derivation). In practice, using less than 100% of the theoretical maximum provides numerical stability:

$$
c = \alpha \cdot c_{\max}, \quad \alpha < 1
$$ {#eq-c-safety}

Note that $\mathbf{B}_{\mathrm{init},ij}$ can be negative for sufficiently large $c$, but the transformation guarantees that the final $\mathbf{K}$ remains physically valid.

**Step 2:** Interaction-Reflection-Scattering (Pre-Normalization)

Compute the element-wise product of the exchange factor matrix and the initial reflection-scattering distribution:

$$
\mathbf{K}_{\mathrm{init},ij} = \mathbf{F}_{ij} \cdot \mathbf{B}_{\mathrm{init},ij}
$$ {#eq-k-init}

This represents the probability that radiation emitted from element $i$ interacts with element $j$ and is then reflected-scattered, before normalization.

**Step 3:** Enforce Probability Conservation

Create a matrix that accounts for both reflection-scattering and absorption:

$$
\mathbf{U}_{ij} = \mathbf{K}_{\mathrm{init},ij} + \mathbf{F}_{ij} \cdot \mathbf{P}_{jj}
$$ {#eq-enforce-unity}

Each element either reflects-scatters ($\mathbf{K}_{\mathrm{init}}$) or is absorbed ($\mathbf{F} \cdot \mathbf{P}$).

**Step 4:** Compute Row Sums

Calculate the row sums:

$$
\mathbf{s}_i = \sum_j \mathbf{U}_{ij} = \sum_j (\mathbf{K}_{\mathrm{init},ij} + \mathbf{F}_{ij} \cdot \mathbf{P}_{jj})
$$ {#eq-row-sums}

**Step 5:** Normalize to Row-Stochastic

Normalize the matrix to ensure row sums equal unity:

$$
\mathbf{T}_{ij} = \frac{\mathbf{U}_{ij}}{\mathbf{s}_i}
$$ {#eq-normalize}

This creates a row-stochastic matrix, ensuring that total probability is conserved for radiation emitted from each element $i$.

**Step 6:** Final Interaction-Reflection-Scattering Matrix

Extract the reflection-scattering component:

$$
\mathbf{K}_{ij} = \mathbf{T}_{ij} - \mathbf{F}_{ij} \cdot \mathbf{P}_{jj}
$$ {#eq-k-final}

Substituting from @eq-normalize:

$$
\mathbf{K}_{ij} = \frac{\mathbf{K}_{\mathrm{init},ij} + \mathbf{F}_{ij} \cdot \mathbf{P}_{jj}}{\mathbf{s}_i} - \mathbf{F}_{ij} \cdot \mathbf{P}_{jj}
$$ {#eq-k-explicit}

Simplifying:

$$
\mathbf{K}_{ij} = \frac{\mathbf{K}_{\mathrm{init},ij}}{\mathbf{s}_i} - \mathbf{F}_{ij} \cdot \mathbf{P}_{jj} \left(1 - \frac{1}{\mathbf{s}_i}\right)
$$ {#eq-k-simplified}

## Properties of the Row Sum Normalization Factor

### Bounds on s

From @eq-row-sums:

$$
\mathbf{s}_i = \sum_j (\mathbf{K}_{\mathrm{init},ij} + \mathbf{F}_{ij} \cdot \mathbf{P}_{jj})
$$

Since $\mathbf{K}_{\mathrm{init},ij} = \mathbf{F}_{ij} \cdot \mathbf{B}_{\mathrm{init},ij}$, we have:

$$
\mathbf{s}_i = \sum_j \mathbf{F}_{ij} \cdot (\mathbf{B}_{\mathrm{init},ij} + \mathbf{P}_{jj})
$$ {#eq-s-expanded}

Since $\mathbf{F}$ is row-stochastic ($\sum_j \mathbf{F}_{ij} = 1$), $\mathbf{F}_{ij} \geq 0$, and $\mathbf{P}_{jj} = 1-\mathbf{b}_j > 0$:

$$
\mathbf{s}_i > 0
$$ {#eq-s-lower-bound}

The normalization factor $\mathbf{s}_i$ is always positive, preventing division by zero in equations @eq-k-explicit and @eq-k-simplified.

### Special Case: Isotropic Limit

When $\mathbf{\Gamma}_{ij} = 0.5$ for all $i,j$ (or equivalently when $c = 0$), we have $\mathbf{B}_{\mathrm{init},ij} = \mathbf{b}_j$ (column-constant):

$$
\mathbf{s}_i = \sum_j \mathbf{F}_{ij} \cdot (\mathbf{b}_j + (1-\mathbf{b}_j)) = \sum_j \mathbf{F}_{ij} = 1
$$

Therefore, the normalization does nothing, and:

$$
\mathbf{K}_{ij} = \mathbf{F}_{ij} \cdot \mathbf{b}_j
$$

This recovers the isotropic case exactly: $\mathbf{K} = \mathbf{F} \circ \mathbf{B}$, where $\mathbf{B}$ is the column-constant matrix of reflection-scattering coefficients.

## Subsequent Transformation

Once $\mathbf{K}$ is constructed, the remainder of the exchange factor transformation proceeds almost identically to the isotropic case:

The steady-state path matrix is given by:

$$
\mathbf{S}_\infty = (\mathbf{I} - \mathbf{K})^{-1} \mathbf{F}
$$ {#eq-s-infinity}

The absorption and reflection-scattering matrices are given by the alternate formulation:

$$
\mathbf{A} = \mathbf{P}(\mathbf{I}-\mathbf{K})^{-1}(\mathbf{F}-\mathbf{K})
$$ {#eq-a-matrix}

$$
\mathbf{R} = \mathbf{P}(\mathbf{I}-\mathbf{K})^{-1}\mathbf{K}
$$ {#eq-r-matrix}

The system matrice $\mathbf{C}$ and $\mathbf{D}$ are given by:

$$
\mathbf{C} = \mathbf{I} - \mathbf{A}^T - \mathbf{R}^T
$$ {#eq-c-matrix}

$$
\mathbf{D} = \mathbf{I} - \mathbf{R}^T
$$ {#eq-d-matrix}

The mixed boundary system is solved as:

$$
\mathbf{M}\mathbf{j} = \mathbf{h}
$$ {#eq-system}

where $\mathbf{M}$ is assembled row-by-row from $\mathbf{C}$ (for known sources) and $\mathbf{D}$ (for known emissive powers), and $\mathbf{j}$ is the total radiant power vector.

## Advantages of the Anisotropic Extension

1. **Physical Fidelity**: Captures directional dependence of reflection-scattering, enabling more accurate modeling of real materials and surfaces.

2. **Analytical Framework**: Maintains the analytical structure of the exchange factor transformation, avoiding iterative Monte Carlo methods.

3. **Backward Compatibility**: Reduces exactly to the isotropic case when $\mathbf{\Gamma}_{ij} = 0.5$ for all elements (or $c = 0$), ensuring consistency with established methods.

4. **Preserved Properties**: Non-negativity ($\mathbf{K} \geq 0$) and physical bounds ($\mathbf{K} \leq \mathbf{F}$) are guaranteed by proper choice of the scaling coefficient $c$ (see Chapter @sec-exchange_fact_anisotropic_extend_analysis for proofs).

5. **Maximum Flexibility**: The analytical bounds on $c$ provide the maximum possible anisotropic variation while maintaining physical validity. For typical radiative transfer problems with $N \sim 1000$ elements, the exact bounds can provide 100-200Ã— more freedom than conservative estimates.

6. **Element-Wise Control**: Full $N \times N$ degrees of freedom in $\mathbf{B}_{\mathrm{init}}$ allow each incident-receiver pair to have independent anisotropic behavior.

## Physical Applications

For surfaces with specular components, media with anisotropic scattering phase functions (e.g., Mie scattering, Henyey-Greenstein, i.e. (ij,k)-three-index dependencies) and surfaces with oriented microstructure (e.g., brushed metal, fibrous materials), more complex models are required.

## Conclusion

The anisotropic extension of the exchange factor transformation provides a mathematically rigorous and physically meaningful framework for modeling directional reflection-scattering in radiative transfer. By introducing the anisotropy matrix $\mathbf{\Gamma}$ with the bounded perturbation parameterization, and employing row-stochastic normalization, the method preserves all essential properties while significantly expanding the range of physical phenomena that can be accurately modeled.