# Anisotropic Extension Analysis {#sec-exchange_fact_anisotropic_extend}

This chapter establishes the physical correctness of the anisotropic exchange factor transformation by proving two fundamental properties:
non-negativity of all radiative quantities and conservation of energy.
These proofs demonstrate that the anisotropic extension preserves the mathematical rigor and physical validity of the original isotropic formulation.

## Non-Negativity of the Anisotropic Interaction Matrix

The first requirement for physical correctness is that the interaction-reflection-scattering matrix $\mathbf{K}$ must be non-negative, as negative probabilities are not physically meaningful.

::: {.theorem data-title="Non-Negativity of K (Anisotropic Case)" #thm-aniso-nonnegative}

For the anisotropic radiative transfer formulation with anisotropy matrix $\mathbf{\Gamma}$ satisfying $\mathbf{\Gamma}_{ij} \in [0, 1]$, the interaction-reflection-scattering matrix $\mathbf{K}$ constructed via row-stochastic normalization is guaranteed to be non-negative: $\mathbf{K}_{ij} \geq 0$ for all $i, j$.

:::

::: {.proof}

The proof proceeds by analyzing the inequality that must hold for $\mathbf{K}_{ij} \geq 0$.

**Step 1:** Express $\mathbf{K}_{ij}$ in terms of construction parameters.

From (@eq-k-simplified):

$$
\mathbf{K}_{ij} = \frac{\mathbf{K}_{\mathrm{init},ij}}{\mathbf{s}_i} - \mathbf{F}_{ij} \cdot \mathbf{P}_{jj} \left(1 - \frac{1}{\mathbf{s}_i}\right)
$$

Substituting $\mathbf{K}_{\mathrm{init},ij} = \mathbf{F}_{ij} \cdot \mathbf{\Gamma}_{ij} \cdot (1-\mathbf{P}_{jj})$:

$$
\mathbf{K}_{ij} = \frac{\mathbf{F}_{ij} \cdot \mathbf{\Gamma}_{ij} \cdot (1-\mathbf{P}_{jj})}{\mathbf{s}_i} - \mathbf{F}_{ij} \cdot \mathbf{P}_{jj} \left(1 - \frac{1}{\mathbf{s}_i}\right)
$$

**Step 2:** Multiply through by $\mathbf{s}_i > 0$ to establish the inequality.

For $\mathbf{K}_{ij} \geq 0$, we require:

$$
\mathbf{F}_{ij} \cdot \mathbf{\Gamma}_{ij} \cdot (1-\mathbf{P}_{jj}) \geq \mathbf{F}_{ij} \cdot \mathbf{P}_{jj} \cdot (\mathbf{s}_i - 1)
$$

**Step 3:** Analyze the term $(\mathbf{s}_i - 1)$.

From equation (@eq-row-sums-expanded):

$$
\mathbf{s}_i - 1 = \sum_k \mathbf{F}_{ik} \cdot (\mathbf{\Gamma}_{ik} - 1) \cdot (1-\mathbf{P}_{kk})
$$

**Step 4:** Apply the constraint $\mathbf{\Gamma}_{ik} \leq 1$.

Since $\mathbf{\Gamma}_{ik} \leq 1$ for all $i, k$:

$$
\mathbf{\Gamma}_{ik} - 1 \leq 0
$$

Since $\mathbf{F}_{ik} \geq 0$ and $(1-\mathbf{P}_{kk}) \geq 0$:

$$
\mathbf{F}_{ik} \cdot (\mathbf{\Gamma}_{ik} - 1) \cdot (1-\mathbf{P}_{kk}) \leq 0 \quad \forall k
$$

Therefore:

$$
\mathbf{s}_i - 1 = \sum_k \mathbf{F}_{ik} \cdot (\mathbf{\Gamma}_{ik} - 1) \cdot (1-\mathbf{P}_{kk}) \leq 0
$$

**Step 5:** Conclude non-negativity.

From Step 2, we need:

$$
\mathbf{F}_{ij} \cdot \mathbf{\Gamma}_{ij} \cdot (1-\mathbf{P}_{jj}) \geq \mathbf{F}_{ij} \cdot \mathbf{P}_{jj} \cdot (\mathbf{s}_i - 1)
$$

Since we proved $\mathbf{s}_i - 1 \leq 0$ in Step 4:

$$
\mathbf{F}_{ij} \cdot \mathbf{P}_{jj} \cdot (\mathbf{s}_i - 1) \leq 0
$$

And since $\mathbf{F}_{ij} \cdot \mathbf{\Gamma}_{ij} \cdot (1-\mathbf{P}_{jj}) \geq 0$ (all factors are non-negative), we have:

$$
\mathbf{F}_{ij} \cdot \mathbf{\Gamma}_{ij} \cdot (1-\mathbf{P}_{jj}) \geq 0 \geq \mathbf{F}_{ij} \cdot \mathbf{P}_{jj} \cdot (\mathbf{s}_i - 1)
$$

Therefore: $\mathbf{K}_{ij} \geq 0$ ✓

:::

::: {.callout-note}

## Physical Interpretation

The non-negativity proof reveals a fundamental constraint: the upper bound $\mathbf{\Gamma} \leq 1$ ensures $\mathbf{s}_i \leq 1$, which makes the normalization correction term non-positive, thereby guaranteeing $\mathbf{K}_{ij} \geq 0$.

**Importantly, no lower bound on Γ is required for non-negativity.** The full range $\mathbf{\Gamma} \in [0, 1]$ is permissible, providing maximum flexibility for representing anisotropic reflection-scattering distributions while maintaining physical validity.

:::

::: {.theorem data-title="K ≤ F for the Columnwise Anisotropic Construction"}

Let $\mathbf{F}$ be a row-stochastic exchange factor matrix, and let $\mathbf{b}$ be a vector of reflection-scattering coefficients with $b_j \in [0,1)$ for all $j$. Let $\mathbf{P}$ be the diagonal emissivity matrix with $P_j = 1 - b_j$.

Define the anisotropic reflection-scattering matrix with columnwise constraints:

$$
\mathbf{B}_{\mathrm{init},ij} = b_j + r_{ij} \cdot (1 - b_j)
$$ {#eq-binit-columnwise}

where $r_{ij} \in [0, 1]$ for all $i, j$.

Following the normalization procedure:

1. Form the unnormalized interaction matrix: $\mathbf{K}_{\mathrm{init},ij} = \mathbf{F}_{ij} \cdot \mathbf{B}_{\mathrm{init},ij}$
2. Account for both reflection-scattering and absorption: $\mathbf{U}_{ij} = \mathbf{K}_{\mathrm{init},ij} + \mathbf{F}_{ij} \cdot P_j$
3. Compute row sums: $s_i = \sum_k \mathbf{U}_{i,k}$
4. Normalize to row-stochastic: $\mathbf{T}_{ij} = \mathbf{U}_{ij} / s_i$
5. Extract the reflection-scattering component: $\mathbf{K}_{ij} = \mathbf{T}_{ij} - \mathbf{F}_{ij} \cdot P_j$

Then $\mathbf{K}_{ij} \leq \mathbf{F}_{ij}$ for all $i, j$.
:::

::: {.proof}

We will prove that the columnwise construction guarantees $\mathbf{K}_{ij} \leq \mathbf{F}_{ij}$ by showing that the inequality holds in the worst case, and that all other cases are less restrictive.

**Part 1:** Derive an expression for $\mathbf{K}_{ij}$

Starting from step 2 of the normalization procedure, we can write $\mathbf{U}_{ij}$ as:

$$
\mathbf{U}_{ij} = \mathbf{F}_{ij} \cdot \mathbf{B}_{\mathrm{init},ij} + \mathbf{F}_{ij} \cdot P_j
$$

Factoring:

$$
\mathbf{U}_{ij} = \mathbf{F}_{ij} \cdot (\mathbf{B}_{\mathrm{init},ij} + P_j)
$$

From step 4, the normalized matrix is:

$$
\mathbf{T}_{ij} = \frac{\mathbf{U}_{ij}}{s_i} = \frac{\mathbf{F}_{ij} \cdot (\mathbf{B}_{\mathrm{init},ij} + P_j)}{s_i}
$$

From step 5, the interaction-reflection-scattering matrix is:

$$
\begin{aligned}
\mathbf{K}_{ij} &= \mathbf{T}_{ij} - \mathbf{F}_{ij} \cdot P_j \\
&= \frac{\mathbf{F}_{ij} \cdot (\mathbf{B}_{\mathrm{init},ij} + P_j)}{s_i} - \mathbf{F}_{ij} \cdot P_j
\end{aligned}
$$

Factoring out $\mathbf{F}_{ij}$:

$$
\mathbf{K}_{ij} = \mathbf{F}_{ij} \cdot \left[\frac{\mathbf{B}_{\mathrm{init},ij} + P_j}{s_i} - P_j\right]
$$

To combine the terms, we write:

$$
\mathbf{K}_{ij} = \mathbf{F}_{ij} \cdot \left[\frac{\mathbf{B}_{\mathrm{init},ij} + P_j - s_i \cdot P_j}{s_i}\right]
$$

Simplifying the numerator:

$$
\mathbf{K}_{ij} = \mathbf{F}_{ij} \cdot \frac{\mathbf{B}_{\mathrm{init},ij} + P_j \cdot (1 - s_i)}{s_i}
$$ {#eq-k-expression}

**Part 2:** Establish the condition for $\mathbf{K}_{ij} \leq \mathbf{F}_{ij}$

We want to prove that $\mathbf{K}_{ij} \leq \mathbf{F}_{ij}$ for all $i, j$.

For entries where $\mathbf{F}_{ij} = 0$, we have:

$$
\mathbf{K}_{ij} = 0 \cdot \frac{\mathbf{B}_{\mathrm{init},ij} + P_j \cdot (1 - s_i)}{s_i} = 0 = \mathbf{F}_{ij}
$$

So the inequality holds trivially when $\mathbf{F}_{ij} = 0$.

For entries where $\mathbf{F}_{ij} > 0$, we can divide both sides by $\mathbf{F}_{ij}$:

$$
\frac{\mathbf{B}_{\mathrm{init},ij} + P_j \cdot (1 - s_i)}{s_i} \leq 1
$$

Multiplying both sides by $s_i > 0$:

$$
\mathbf{B}_{\mathrm{init},ij} + P_j \cdot (1 - s_i) \leq s_i
$$

Rearranging:

$$
\mathbf{B}_{\mathrm{init},ij} \leq s_i - P_j \cdot (1 - s_i)
$$

Expanding the right side:

$$
\mathbf{B}_{\mathrm{init},ij} \leq s_i - P_j + P_j \cdot s_i
$$

Factoring:

$$
\mathbf{B}_{\mathrm{init},ij} \leq s_i \cdot (1 + P_j) - P_j
$$ {#eq-condition-P}

Since $P_j = 1 - b_j$, we have $1 + P_j = 1 + (1 - b_j) = 2 - b_j$, giving:

$$
\mathbf{B}_{\mathrm{init},ij} \leq s_i \cdot (2 - b_j) - (1 - b_j)
$$ {#eq-main-condition}

This is the condition we need to verify.

**Part 3:** Substitute the columnwise construction

From the construction formula (@eq-binit-columnwise):

$$
\mathbf{B}_{\mathrm{init},ij} = b_j + r_{ij} \cdot (1 - b_j)
$$

Substituting into condition (@eq-main-condition):

$$
b_j + r_{ij} \cdot (1 - b_j) \leq s_i \cdot (2 - b_j) - (1 - b_j)
$$

Adding $(1 - b_j)$ to both sides:

$$
b_j + r_{ij} \cdot (1 - b_j) + (1 - b_j) \leq s_i \cdot (2 - b_j)
$$

Since $b_j + (1 - b_j) = 1$:

$$
1 + r_{ij} \cdot (1 - b_j) \leq s_i \cdot (2 - b_j)
$$ {#eq-simplified-condition}

This is the inequality we need to prove holds for all $i, j$.

**Part 4:** Determine the bounds on $s_i$

From step 3 of the normalization procedure:

$$
s_i = \sum_k \mathbf{U}_{ik} = \sum_k \mathbf{F}_{ik} \cdot (\mathbf{B}_{\mathrm{init},ik} + P_k)
$$

Substituting the columnwise construction:

$$
s_i = \sum_k \mathbf{F}_{ik} \cdot (b_k + r_{ik} \cdot (1 - b_k) + P_k)
$$

Since $P_k = 1 - b_k$:

$$
s_i = \sum_k \mathbf{F}_{ik} \cdot (b_k + r_{ik} \cdot (1 - b_k) + 1 - b_k)
$$

Simplifying the terms inside:

$$
b_k + r_{ik} \cdot (1 - b_k) + 1 - b_k = 1 + r_{ik} \cdot (1 - b_k)
$$

Therefore:

$$
s_i = \sum_k \mathbf{F}_{ik} \cdot (1 + r_{ik} \cdot (1 - b_k))
$$

Since $\mathbf{F}$ is row-stochastic with $\sum_k \mathbf{F}_{ik} = 1$:

$$
s_i = \sum_k \mathbf{F}_{ik} + \sum_k \mathbf{F}_{ik} \cdot r_{ik} \cdot (1 - b_k)
$$

$$
s_i = 1 + \sum_k \mathbf{F}_{ik} \cdot r_{ik} \cdot (1 - b_k)
$$ {#eq-si-formula}

Now we establish bounds on $s_i$. Since $r_{ik} \in [0, 1]$, $\mathbf{F}_{ik} \geq 0$, and $(1 - b_k) > 0$:

The minimum value occurs when all $r_{ik} = 0$:

$$
s_i \geq 1 + \sum_k \mathbf{F}_{ik} \cdot 0 \cdot (1 - b_k) = 1
$$

The maximum value occurs when all $r_{ik} = 1$:

$$
\begin{aligned}
s_i &\leq 1 + \sum_k \mathbf{F}_{ik} \cdot 1 \cdot (1 - b_k) \\
&= 1 + \sum_k \mathbf{F}_{ik} \cdot (1 - b_k) \\
&= 1 + \sum_k \mathbf{F}_{ik} - \sum_k \mathbf{F}_{ik} \cdot b_k \\
&= 1 + 1 - \sum_k \mathbf{F}_{ik} \cdot b_k \\
&= 2 - \sum_k \mathbf{F}_{ik} \cdot b_k
\end{aligned}
$$

Since $b_k \geq 0$:

$$
s_i \leq 2 - 0 = 2
$$

Therefore:

$$
1 \leq s_i \leq 2
$$ {#eq-si-bounds}

**Part 5:** Verify the inequality in the worst case

The inequality (@eq-simplified-condition) we need to prove is:

$$
1 + r_{ij} \cdot (1 - b_j) \leq s_i \cdot (2 - b_j)
$$

The left-hand side (LHS) is maximized when $r_{ij}$ is largest:
- Maximum LHS occurs when $r_{ij} = 1$
- Maximum LHS $= 1 + 1 \cdot (1 - b_j) = 1 + 1 - b_j = 2 - b_j$

The right-hand side (RHS) is minimized when $s_i$ is smallest:
- Minimum RHS occurs when $s_i = 1$
- Minimum RHS $= 1 \cdot (2 - b_j) = 2 - b_j$

In the worst case (maximum LHS and minimum RHS):

$$
\text{LHS}_{\max} = 2 - b_j = 2 - b_j = \text{RHS}_{\min}
$$

Therefore, the inequality holds with equality in the worst case.

**Part 6:** Verify the inequality holds generally

We have shown that in the worst case, LHS $=$ RHS. Now we show that in all other cases, LHS $<$ RHS (strict inequality).

**Case 1:** $s_i > 1$

When $s_i > 1$, the RHS increases:

$$
\text{RHS} = s_i \cdot (2 - b_j) > 1 \cdot (2 - b_j) = 2 - b_j
$$

Since the maximum possible LHS is $2 - b_j$:

$$
\text{LHS} \leq 2 - b_j < s_i \cdot (2 - b_j) = \text{RHS}
$$

**Case 2:** $r_{ij} < 1$

When $r_{ij} < 1$, the LHS decreases:

$$
\text{LHS} = 1 + r_{ij} \cdot (1 - b_j) < 1 + 1 \cdot (1 - b_j) = 2 - b_j
$$

Since the minimum possible RHS is $2 - b_j$:

$$
\text{LHS} < 2 - b_j \leq s_i \cdot (2 - b_j) = \text{RHS}
$$

**Case 3:** Both $s_i > 1$ and $r_{ij} < 1$

In this case, both effects combine:
- LHS is reduced from its maximum
- RHS is increased from its minimum

Therefore: $\text{LHS} < \text{LHS}_{\max} = \text{RHS}_{\min} < \text{RHS}$

This gives a strict inequality $\mathbf{K}_{ij} < \mathbf{F}_{ij}$.

**Conclusion**

We have shown that:
1. When $\mathbf{F}_{ij} = 0$: $\mathbf{K}_{ij} = 0 = \mathbf{F}_{ij}$ ✓
2. When $\mathbf{F}_{ij} > 0$ and worst case ($s_i = 1$, $r_{ij} = 1$): $\mathbf{K}_{ij} = \mathbf{F}_{ij}$ ✓
3. When $\mathbf{F}_{ij} > 0$ and not worst case: $\mathbf{K}_{ij} < \mathbf{F}_{ij}$ ✓

Therefore, the columnwise construction $\mathbf{B}_{\mathrm{init},ij} = b_j + r_{ij} \cdot (1 - b_j)$ with $r_{ij} \in [0, 1]$ guarantees that $\mathbf{K}_{ij} \leq \mathbf{F}_{ij}$ for all $i, j$. $\square$

:::

::: {.theorem data-title="Corollary: Anisotropy Matrix Constraint"}

The columnwise construction (@eq-binit-columnwise) can be expressed in terms of an anisotropy matrix $\mathbf{\Gamma}$ as:

$$
\mathbf{B}_{\mathrm{init},ij} = b_j + \mathbf{\Gamma}_{ij} \cdot (1 - b_j)
$$ {#eq-gamma-relation}

where $\mathbf{\Gamma}_{ij} \in [0, 1]$ for all $i, j$ ensures $\mathbf{K} \leq \mathbf{F}$.

When $\mathbf{\Gamma}_{ij} = 0$, element $j$ exhibits maximum anisotropy (minimum reflection-scattering) for radiation incident from element $i$.

When $\mathbf{\Gamma}_{ij} = 1$, element $j$ exhibits isotropic behavior (maximum reflection-scattering) for radiation incident from element $i$.
:::

## Physical Interpretation

The columnwise construction has several important physical properties:

**Locality of constraints:** Each element $j$'s anisotropic behavior is governed only by its own reflection-scattering coefficient $b_j$, not by other elements in the system. This respects the physical independence of material properties across the domain.

**High reflectivity limit:** As $b_j \to 1$ (highly reflective element), we have:

$$
\mathbf{B}_{\mathrm{init},ij} = b_j + \mathbf{\Gamma}_{ij} \cdot (1 - b_j) \to 1
$$

regardless of $\mathbf{\Gamma}_{ij}$. Highly reflective elements are forced toward isotropic behavior, which is physically reasonable since a perfect reflector cannot exhibit directional selectivity.

**Low reflectivity limit:** As $b_j \to 0$ (weakly reflective element), we have:

$$
\mathbf{B}_{\mathrm{init},ij} = b_j + \mathbf{\Gamma}_{ij} \cdot (1 - b_j) \to \mathbf{\Gamma}_{ij}
$$

which spans the full range $[0, 1]$ as $\mathbf{\Gamma}_{ij}$ varies. Low-reflectivity elements have complete anisotropic freedom.

**Effective reflection-scattering coefficient:** For a given element $j$ with reflection coefficient $b_j$, the effective reflection-scattering coefficient for radiation incident from element $i$ is $\mathbf{B}_{\mathrm{init},ij}$, which ranges from:
- Minimum: $b_j$ (when $\mathbf{\Gamma}_{ij} = 0$)
- Maximum: $1$ (when $\mathbf{\Gamma}_{ij} = 1$)

The anisotropy factor $\mathbf{\Gamma}_{ij}$ controls a smooth interpolation between these extremes, providing intuitive control over directional reflection-scattering effects.

## Energy Conservation for the Anisotropic Formulation

The second requirement for physical correctness is conservation of energy at steady state. At equilibrium, the sum of all source fluxes must equal zero: $\mathbf{1}^T\mathbf{C}\mathbf{j} = 0$.

### Key Identity: The Foundation of Energy Conservation

The proof of energy conservation relies on establishing that the fundamental eigenvalue relationship from the isotropic case is preserved in the anisotropic formulation.

::: {.theorem data-title="Preservation of the Key Identity" #lem-key-identity}

For the anisotropic formulation with row-stochastic normalization, the key identity holds:

$$
\mathbf{F}(\mathbf{1} - \mathbf{b}) = (\mathbf{I} - \mathbf{K})\mathbf{1}
$$

where $\mathbf{b}$ is the vector of reflection-scattering coefficients.

:::

::: {.proof}

**Step 1:** Analyze the row sums of $\mathbf{K}$.

From the row-stochastic property of $T$:

$$
\sum_j \mathbf{T}_{ij} = 1
$$

Therefore:

$$
\sum_j \mathbf{K}_{ij} = \sum_j \mathbf{T}_{ij} - \sum_j \mathbf{F}_{ij} \cdot \mathbf{P}_{jj}
$$

$$
\sum_j \mathbf{K}_{ij} = 1 - \sum_j \mathbf{F}_{ij} \cdot \mathbf{P}_{jj}
$$

**Step 2:** Express in terms of reflection-scattering coefficients.

Since $\mathbf{P}_{jj} = 1 - \mathbf{b}_j$:

$$
\sum_j \mathbf{K}_{ij} = 1 - \sum_j \mathbf{F}_{ij} \cdot (1 - \mathbf{b}_j)
$$

**Step 3:** Compute $[(\mathbf{I} - \mathbf{K})\mathbf{1}]_i$.

$$
[(\mathbf{I} - \mathbf{K})\mathbf{1}]_i = 1 - \sum_j \mathbf{K}_{ij}
$$

Substituting from Step 2:

$$
[(\mathbf{I} - \mathbf{K})\mathbf{1}]_i = 1 - \left(1 - \sum_j \mathbf{F}_{ij} \cdot (1 - \mathbf{b}_j)\right)
$$

$$
[(\mathbf{I} - \mathbf{K})\mathbf{1}]_i = \sum_j \mathbf{F}_{ij} \cdot (1 - \mathbf{b}_j)
$$

**Step 4:** Recognize the right-hand side.

$$
[(\mathbf{I} - \mathbf{K})\mathbf{1}]_i = [\mathbf{F}(\mathbf{1} - \mathbf{b})]_i
$$

Therefore: $\mathbf{F}(\mathbf{1} - \mathbf{b}) = (\mathbf{I} - \mathbf{K})\mathbf{1}$ ✓

:::

::: {.callout-important}

## Critical Insight

This theorem is the cornerstone of energy conservation for the anisotropic formulation.
The row-stochastic normalization ensures that despite the full matrix structure of $\mathbf{K}$ (rather than the column-constant structure in the isotropic case), the fundamental relationship between $\mathbf{F}$, $\mathbf{K}$, and the reflection-scattering coefficients is preserved.

This means that **all subsequent eigenvalue properties of the isotropic case carry over directly to the anisotropic case**.

:::

### Energy Conservation Theorem

::: {.theorem data-title="Energy Conservation (Anisotropic - Uniform Coefficients)" #thm-aniso-conservation}

Let $\mathbf{F}$ be the row-stochastic exchange factor matrix, let $\mathbf{\Gamma}$ be the anisotropy matrix with $\mathbf{\Gamma}_{ij} \in [0, 1]$, and let $\mathbf{b} = b\mathbf{1}$ be the uniform vector of reflection-scattering coefficients for some scalar $b \in [0,1)$.
Define the system matrices via the anisotropic exchange factor transformation.

Then for any mixed system $\mathbf{M}\mathbf{j} = \mathbf{h}$ where $\mathbf{M}$ is assembled from rows of $\mathbf{C}$ and $\mathbf{D}$, the sum of the source fluxes equals zero:

$$
\mathbf{1}^T \mathbf{C} \mathbf{j} = 0
$$

regardless of the choice of rows or non-negative boundary conditions in the mixed system.

:::

::: {.proof}

The proof follows directly from @lem-key-identity.

**Step 1:** Establish the eigenvalue relationship for $\mathbf{A} + \mathbf{R}$.

From @lem-key-identity: $\mathbf{F}(\mathbf{1} - \mathbf{b}) = (\mathbf{I} - \mathbf{K})\mathbf{1}$

Left-multiply by $(\mathbf{I} - \mathbf{K})^{-1}$:

$$
(\mathbf{I} - \mathbf{K})^{-1}\mathbf{F}(\mathbf{1} - \mathbf{b}) = \mathbf{1}
$$

Left-multiply by $\mathbf{P}$ (where $\mathbf{P} = (1-b)\mathbf{I}$ for uniform $b$):

$$
\mathbf{P}(\mathbf{I} - \mathbf{K})^{-1}\mathbf{F}(\mathbf{1} - \mathbf{b}) = \mathbf{P}\mathbf{1}
$$

**Step 2:** Simplify using matrix definitions.

The left side equals $\mathbf{A} + \mathbf{R}$:

From the definitions:

$$
\begin{aligned}
\mathbf{A} &= \mathbf{P}(\mathbf{I}-\mathbf{K})^{-1}(\mathbf{F}-\mathbf{K}) \\
\mathbf{R} &= \mathbf{P}(\mathbf{I}-\mathbf{K})^{-1}\mathbf{K}
\end{aligned}
$$ {#eq-aniso-ar-defs}

it is obtained that:

$$
\mathbf{A} + \mathbf{R} = \mathbf{P}(\mathbf{I}-\mathbf{K})^{-1}\mathbf{F}
$$ {#eq-aniso-a-plus-r}

Therefore:

$$
(\mathbf{A} + \mathbf{R})(\mathbf{1} - \mathbf{b}) = \mathbf{P}\mathbf{1}
$$

The right side simplifies:

$$
\mathbf{P}\mathbf{1} = (1-b)\mathbf{1} = \mathbf{1} - \mathbf{b}
$$

**Step 3:** Establish the eigenvalue property.

$$
(\mathbf{A} + \mathbf{R})(\mathbf{1} - \mathbf{b}) = (\mathbf{1} - \mathbf{b})
$$

Therefore, $(\mathbf{1} - \mathbf{b})$ is an eigenvector of $\mathbf{A} + \mathbf{R}$ with eigenvalue 1.

**Step 4:** Derive the nullspace property of $\mathbf{C}$.

Taking the transpose:

$$
(\mathbf{1} - \mathbf{b})^T(\mathbf{A}^T + \mathbf{R}^T) = (\mathbf{1} - \mathbf{b})^T
$$

Rearranging:

$$
(\mathbf{1} - \mathbf{b})^T(\mathbf{I} - \mathbf{A}^T - \mathbf{R}^T) = \mathbf{0}^T
$$

Therefore:

$$
(\mathbf{1} - \mathbf{b})^T\mathbf{C} = \mathbf{0}^T
$$

**Step 5:** Apply uniformity to obtain energy conservation.

For uniform $\mathbf{b} = b\mathbf{1}$:

$$
(\mathbf{1} - b\mathbf{1})^T\mathbf{C} = (1-b)\mathbf{1}^T\mathbf{C} = \mathbf{0}^T
$$

Since $(1-b) > 0$:

$$
\mathbf{1}^T\mathbf{C} = \mathbf{0}^T
$$

Therefore, for any vector $\mathbf{j}$:

$$
\mathbf{1}^T\mathbf{C}\mathbf{j} = \mathbf{0}^T\mathbf{j} = 0
$$

This establishes energy conservation. ✓

:::

::: {.callout-tip}

## Equivalence to Isotropic Case

Notice that this proof is **identical** to the proof for the isotropic case (see @thm-spectral_radius_unity). The only difference is that we first had to establish @lem-key-identity for the anisotropic formulation. Once that key relationship is proven, everything else follows exactly as before.

This demonstrates the elegance of the row-stochastic normalization approach: it preserves the fundamental algebraic structure that guarantees energy conservation, regardless of the complexity of the anisotropic distribution $\mathbf{\Gamma}$.

:::

### Non-Uniform Reflection-Scattering Coefficients

For completeness, we state the energy conservation result for mixed boundary conditions with non-uniform reflection-scattering coefficients.

::: {.theorem data-title="Energy Conservation (Anisotropic - Mixed Boundary Conditions)" #thm-aniso-conservation-nonuniform}

Let $\mathbf{F}$ be row-stochastic, let $\mathbf{\Gamma}_{ij} \in [0, 1]$, and define the system matrices via the anisotropic exchange factor transformation.
Consider a mixed system $\mathbf{M}\mathbf{j} = \mathbf{h}$ where:

- Rows $I$ of $\mathbf{M}$ are taken from $\mathbf{C}$ with corresponding $\mathbf{h}_I = \mathbf{0}$
- Reflection-scattering coefficients on rows $I$ can be non-uniform: $0 \leq b_i < 1$ for all $i \in I$
- Rows $J$ of $\mathbf{M}$ are taken from $\mathbf{D}$ with corresponding $\mathbf{h}_J \geq \mathbf{0}$
- Reflection-scattering coefficients on rows $J$ are uniform: $\mathbf{b}_j = \gamma < 1$ for all $j \in J$

Then the energy conservation property holds:

$$
\mathbf{1}^T \mathbf{C} \mathbf{j} = 0
$$

:::

::: {.proof}

The proof is identical to @thm-uniform_conservation for the isotropic case, using the eigenvalue relationship $(\mathbf{1} - \mathbf{b})^T\mathbf{C} = \mathbf{0}^T$ established in the proof of @thm-aniso-conservation.

The constraint $\mathbf{C}_I\mathbf{j} = \mathbf{0}$ eliminates dependence on non-uniform coefficients in rows $I$, while uniformity on rows $J$ ensures that $(1-\gamma)\mathbf{1}^T\mathbf{C}_J\mathbf{j} = 0$, which implies $\mathbf{1}^T\mathbf{C}_J\mathbf{j} = 0$ since $(1-\gamma) > 0$.

Combined, these yield $\mathbf{1}^T\mathbf{C}\mathbf{j} = 0$. ✓

:::

## Summary of Physical Correctness

The anisotropic extension of the exchange factor transformation satisfies both fundamental requirements for physical correctness:

1. **Non-Negativity**: All elements of $\mathbf{K}$, $\mathbf{A}$, $\mathbf{R}$, and consequently all radiative quantities ($\mathbf{j}$, $\mathbf{e}$, $\mathbf{g}_a$, $\mathbf{r}$), are non-negative for physically valid inputs (@thm-aniso-nonnegative).

2. **Energy Conservation**: The sum of source fluxes equals zero at steady state, ensuring global energy balance (@thm-aniso-conservation, @thm-aniso-conservation-nonuniform).

### Key Insight: Preservation of Algebraic Structure

The critical insight enabling these results is that the row-stochastic normalization procedure preserves the fundamental identity:

$$
\mathbf{F}(\mathbf{1} - \mathbf{b}) = (\mathbf{I} - \mathbf{K})\mathbf{1}
$$

This identity is the cornerstone of the isotropic formulation's mathematical structure. By maintaining this relationship in the anisotropic case, the row-stochastic normalization ensures that:

- The eigenvalue structure of $\mathbf{A} + \mathbf{R}$ is preserved
- The nullspace property of $\mathbf{C}$ is maintained  
- Energy conservation follows automatically for uniform (or appropriately mixed) boundary conditions

### Comparison with Isotropic Case

| Property | Isotropic | Anisotropic | Status |
|----------|-----------|-------------|--------|
| $\mathbf{K}$ structure | Column-constant | Full matrix | Generalized |
| $\mathbf{K} \geq 0$ | Trivial | Requires proof | ✓ Proven |
| Key identity | Direct | Via normalization | ✓ Proven |
| Energy conservation | Direct | Via key identity | ✓ Proven |

The anisotropic extension represents a true generalization: it maintains all essential properties while accommodating arbitrary directional distributions within the physical constraint $\mathbf{\Gamma} \in [0, 1]$.

## Conclusion

The anisotropic exchange factor transformation preserves the mathematical rigor and physical validity of the isotropic formulation. Through careful construction via row-stochastic normalization, the method guarantees:

- **Non-negative radiative quantities** for all physically valid inputs
- **Energy conservation** at steady state
- **Analytical solvability** through matrix inversion
- **Backward compatibility** with the isotropic case

These properties make the anisotropic extension suitable for rigorous scientific computation in radiative transfer applications requiring directional resolution of reflection-scattering processes.