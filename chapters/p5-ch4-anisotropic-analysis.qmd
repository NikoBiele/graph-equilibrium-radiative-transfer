# Anisotropic Extension Analysis {#sec-exchange_fact_anisotropic_extend}

This chapter establishes the physical correctness of the anisotropic exchange factor transformation by proving two fundamental properties:
non-negativity of all radiative quantities and conservation of energy.
These proofs demonstrate that the anisotropic extension preserves the mathematical rigor and physical validity of the original isotropic formulation.

## Non-Negativity of the Anisotropic Interaction Matrix

The first requirement for physical correctness is that the interaction-reflection-scattering matrix $\textbf{K}$ must be non-negative, as negative probabilities are not physically meaningful.

::: {.theorem data-title="Non-Negativity of K (Anisotropic Case)" #thm-aniso-nonnegative}

For the anisotropic radiative transfer formulation with anisotropy matrix $\textbf{\Gamma}$ satisfying $\textbf{\Gamma}_{ij} \in [0, 1]$, the interaction-reflection-scattering matrix $\textbf{K}$ constructed via row-stochastic normalization is guaranteed to be non-negative: $K_{ij} \geq 0$ for all $i, j$.

:::

::: {.proof}

The proof proceeds by analyzing the inequality that must hold for $\mathbf{K}_{ij} \geq 0$.

**Step 1:** Express $\mathbf{K}_{ij}$ in terms of construction parameters.

From (@eq-k-simplified):

$$
\mathbf{K}[i,j] = \frac{\mathbf{K}_{\text{init}}[i,j]}{S[i]} - F[i,j] \cdot P[j] \left(1 - \frac{1}{S[i]}\right)
$$

Substituting $\mathbf{K}_{\text{init}}[i,j] = F[i,j] \cdot \Gamma[i,j] \cdot (1-P[j])$:

$$
\mathbf{K}[i,j] = \frac{F[i,j] \cdot \Gamma[i,j] \cdot (1-P[j])}{S[i]} - F[i,j] \cdot P[j] \left(1 - \frac{1}{S[i]}\right)
$$

**Step 2:** Multiply through by $S[i] > 0$ to establish the inequality.

For $\mathbf{K}_{ij} \geq 0$, we require:

$$
F[i,j] \cdot \Gamma[i,j] \cdot (1-P[j]) \geq F[i,j] \cdot P[j] \cdot (S[i] - 1)
$$

**Step 3:** Analyze the term $(S[i] - 1)$.

From [Equation XX]:

$$
S[i] - 1 = \sum_k F[i,k] \cdot (\Gamma[i,k] - 1) \cdot (1-P[k])
$$

**Step 4:** Apply the constraint $\Gamma_{ik} \leq 1$.

Since $\Gamma_{ik} \leq 1$ for all $i, k$:

$$
\Gamma[i,k] - 1 \leq 0
$$

Since $F[i,k] \geq 0$ and $(1-P[k]) \geq 0$:

$$
F[i,k] \cdot (\Gamma[i,k] - 1) \cdot (1-P[k]) \leq 0 \quad \forall k
$$

Therefore:

$$
S[i] - 1 = \sum_k F[i,k] \cdot (\Gamma[i,k] - 1) \cdot (1-P[k]) \leq 0
$$

**Step 5:** Conclude non-negativity.

From Step 2, we need:

$$
F[i,j] \cdot \Gamma[i,j] \cdot (1-P[j]) \geq F[i,j] \cdot P[j] \cdot (S[i] - 1)
$$

Since we proved $S[i] - 1 \leq 0$ in Step 4:

$$
F[i,j] \cdot P[j] \cdot (S[i] - 1) \leq 0
$$

And since $F[i,j] \cdot \Gamma[i,j] \cdot (1-P[j]) \geq 0$ (all factors are non-negative), we have:

$$
F[i,j] \cdot \Gamma[i,j] \cdot (1-P[j]) \geq 0 \geq F[i,j] \cdot P[j] \cdot (S[i] - 1)
$$

Therefore: $\mathbf{K}_{ij} \geq 0$ ✓

:::

::: {.callout-note}

## Physical Interpretation

The non-negativity proof reveals a fundamental constraint: the upper bound $\textbf{Γ} \leq 1$ ensures $S[i] \leq 1$, which makes the normalization correction term non-positive, thereby guaranteeing $\mathbf{K}_{ij} \geq 0$.

**Importantly, no lower bound on Γ is required for non-negativity.** The full range $\textbf{Γ} \in [0, 1]$ is permissible, providing maximum flexibility for representing anisotropic reflection-scattering distributions while maintaining physical validity.

:::

## Energy Conservation for the Anisotropic Formulation

The second requirement for physical correctness is conservation of energy at steady state. At equilibrium, the sum of all source fluxes must equal zero: $\textbf{1}^T\textbf{C}\textbf{j} = 0$.

### Key Identity: The Foundation of Energy Conservation

The proof of energy conservation relies on establishing that the fundamental eigenvalue relationship from the isotropic case is preserved in the anisotropic formulation.

::: {.theorem data-title="Preservation of the Key Identity" #lem-key-identity}

For the anisotropic formulation with row-stochastic normalization, the key identity holds:

$$
\textbf{F}(\textbf{1} - \textbf{b}) = (\textbf{I} - \textbf{K})\textbf{1}
$$

where $\textbf{b}$ is the vector of reflection-scattering coefficients.

:::

::: {.proof}

**Step 1:** Analyze the row sums of $\textbf{K}$.

From the row-stochastic property of rowsums_unity:

$$
\sum_j \text{rowsums\_unity}[i,j] = 1
$$

Therefore:

$$
\sum_j \mathbf{K}[i,j] = \sum_j \text{rowsums\_unity}[i,j] - \sum_j F[i,j] \cdot P[j]
$$

$$
\sum_j \mathbf{K}[i,j] = 1 - \sum_j F[i,j] \cdot P[j]
$$

**Step 2:** Express in terms of reflection-scattering coefficients.

Since $P[j] = 1 - b_j$:

$$
\sum_j \mathbf{K}[i,j] = 1 - \sum_j F[i,j] \cdot (1 - b_j)
$$

**Step 3:** Compute $[(\textbf{I} - \textbf{K})\textbf{1}]_i$.

$$
[(\textbf{I} - \textbf{K})\textbf{1}]_i = 1 - \sum_j \mathbf{K}[i,j]
$$

Substituting from Step 2:

$$
[(\textbf{I} - \textbf{K})\textbf{1}]_i = 1 - \left(1 - \sum_j F[i,j] \cdot (1 - b_j)\right)
$$

$$
[(\textbf{I} - \textbf{K})\textbf{1}]_i = \sum_j F[i,j] \cdot (1 - b_j)
$$

**Step 4:** Recognize the right-hand side.

$$
[(\textbf{I} - \textbf{K})\textbf{1}]_i = [\textbf{F}(\textbf{1} - \textbf{b})]_i
$$

Therefore: $\textbf{F}(\textbf{1} - \textbf{b}) = (\textbf{I} - \textbf{K})\textbf{1}$ ✓

:::

::: {.callout-important}

## Critical Insight

This theorem is the cornerstone of energy conservation for the anisotropic formulation.
The row-stochastic normalization ensures that despite the full matrix structure of $\textbf{K}$ (rather than the column-constant structure in the isotropic case), the fundamental relationship between $\textbf{F}$, $\textbf{K}$, and the reflection-scattering coefficients is preserved.

This means that **all subsequent eigenvalue properties of the isotropic case carry over directly to the anisotropic case**.

:::

### Energy Conservation Theorem

::: {.theorem data-title="Energy Conservation (Anisotropic - Uniform Coefficients)" #thm-aniso-conservation}

Let $\textbf{F}$ be the row-stochastic exchange factor matrix, let $\textbf{\Gamma}$ be the anisotropy matrix with $\textbf{\Gamma}_{ij} \in [0, 1]$, and let $\textbf{b} = b\textbf{1}$ be the uniform vector of reflection-scattering coefficients for some scalar $b \in [0,1)$.
Define the system matrices via the anisotropic exchange factor transformation.

Then for any mixed system $\textbf{M}\textbf{j} = \textbf{h}$ where $\textbf{M}$ is assembled from rows of $\textbf{C}$ and $\textbf{D}$, the sum of the source fluxes equals zero:

$$
\textbf{1}^T \textbf{C} \textbf{j} = 0
$$

regardless of the choice of rows or non-negative boundary conditions in the mixed system.

:::

::: {.proof}

The proof follows directly from @lem-key-identity.

**Step 1:** Establish the eigenvalue relationship for $\textbf{A} + \textbf{R}$.

From @lem-key-identity: $\textbf{F}(\textbf{1} - \textbf{b}) = (\textbf{I} - \textbf{K})\textbf{1}$

Left-multiply by $(\textbf{I} - \textbf{K})^{-1}$:

$$
(\textbf{I} - \textbf{K})^{-1}\textbf{F}(\textbf{1} - \textbf{b}) = \textbf{1}
$$

Left-multiply by $\textbf{P}$ (where $\textbf{P} = (1-b)\textbf{I}$ for uniform $b$):

$$
\textbf{P}(\textbf{I} - \textbf{K})^{-1}\textbf{F}(\textbf{1} - \textbf{b}) = \textbf{P}\textbf{1}
$$

**Step 2:** Simplify using matrix definitions.

The left side equals $\textbf{A} + \textbf{R}$ (from [Theorem @thm-spectral_radius_unity]):

$$
(\textbf{A} + \textbf{R})(\textbf{1} - \textbf{b}) = \textbf{P}\textbf{1}
$$

The right side simplifies:

$$
\textbf{P}\textbf{1} = (1-b)\textbf{1} = \textbf{1} - \textbf{b}
$$

**Step 3:** Establish the eigenvalue property.

$$
(\textbf{A} + \textbf{R})(\textbf{1} - \textbf{b}) = (\textbf{1} - \textbf{b})
$$

Therefore, $(\textbf{1} - \textbf{b})$ is an eigenvector of $\textbf{A} + \textbf{R}$ with eigenvalue 1.

**Step 4:** Derive the nullspace property of $\textbf{C}$.

Taking the transpose:

$$
(\textbf{1} - \textbf{b})^T(\textbf{A}^T + \textbf{R}^T) = (\textbf{1} - \textbf{b})^T
$$

Rearranging:

$$
(\textbf{1} - \textbf{b})^T(\textbf{I} - \textbf{A}^T - \textbf{R}^T) = \textbf{0}^T
$$

Therefore:

$$
(\textbf{1} - \textbf{b})^T\textbf{C} = \textbf{0}^T
$$

**Step 5:** Apply uniformity to obtain energy conservation.

For uniform $\textbf{b} = b\textbf{1}$:

$$
(\textbf{1} - b\textbf{1})^T\textbf{C} = (1-b)\textbf{1}^T\textbf{C} = \textbf{0}^T
$$

Since $(1-b) > 0$:

$$
\textbf{1}^T\textbf{C} = \textbf{0}^T
$$

Therefore, for any vector $\textbf{j}$:

$$
\textbf{1}^T\textbf{C}\textbf{j} = \textbf{0}^T\textbf{j} = 0
$$

This establishes energy conservation. ✓

:::

::: {.callout-tip}

## Equivalence to Isotropic Case

Notice that this proof is **identical** to the proof for the isotropic case (see @thm-spectral_radius_unity). The only difference is that we first had to establish @lem-key-identity for the anisotropic formulation. Once that key relationship is proven, everything else follows exactly as before.

This demonstrates the elegance of the row-stochastic normalization approach: it preserves the fundamental algebraic structure that guarantees energy conservation, regardless of the complexity of the anisotropic distribution $\textbf{\Gamma}$.

:::

### Non-Uniform Reflection-Scattering Coefficients

For completeness, we state the energy conservation result for mixed boundary conditions with non-uniform reflection-scattering coefficients.

::: {.theorem data-title="Energy Conservation (Anisotropic - Mixed Boundary Conditions)" #thm-aniso-conservation-nonuniform}

Let $\textbf{F}$ be row-stochastic, let $\mathbf{\Gamma}_{ij} \in [0, 1]$, and define the system matrices via the anisotropic exchange factor transformation.
Consider a mixed system $\textbf{M}\textbf{j} = \textbf{h}$ where:

- Rows $I$ of $\textbf{M}$ are taken from $\textbf{C}$ with corresponding $\textbf{h}_I = \textbf{0}$
- Reflection-scattering coefficients on rows $I$ can be non-uniform: $0 \leq b_i < 1$ for all $i \in I$
- Rows $J$ of $\textbf{M}$ are taken from $\textbf{D}$ with corresponding $\textbf{h}_J \geq \textbf{0}$
- Reflection-scattering coefficients on rows $J$ are uniform: $b_j = \gamma < 1$ for all $j \in J$

Then the energy conservation property holds:

$$
\textbf{1}^T \textbf{C} \textbf{j} = 0
$$

:::

::: {.proof}

The proof is identical to @thm-uniform_conservation for the isotropic case, using the eigenvalue relationship $(\textbf{1} - \textbf{b})^T\textbf{C} = \textbf{0}^T$ established in the proof of @thm-aniso-conservation.

The constraint $\textbf{C}_I\textbf{j} = \textbf{0}$ eliminates dependence on non-uniform coefficients in rows $I$, while uniformity on rows $J$ ensures that $(1-\gamma)\textbf{1}^T\textbf{C}_J\textbf{j} = 0$, which implies $\textbf{1}^T\textbf{C}_J\textbf{j} = 0$ since $(1-\gamma) > 0$.

Combined, these yield $\textbf{1}^T\textbf{C}\textbf{j} = 0$. ✓

:::

## Summary of Physical Correctness

The anisotropic extension of the exchange factor transformation satisfies both fundamental requirements for physical correctness:

1. **Non-Negativity**: All elements of $\textbf{K}$, $\textbf{A}$, $\textbf{R}$, and consequently all radiative quantities ($\textbf{j}$, $\textbf{e}$, $\textbf{g}_a$, $\textbf{r}$), are non-negative for physically valid inputs (@thm-aniso-nonnegative).

2. **Energy Conservation**: The sum of source fluxes equals zero at steady state, ensuring global energy balance (@thm-aniso-conservation, @thm-aniso-conservation-nonuniform).

### Key Insight: Preservation of Algebraic Structure

The critical insight enabling these results is that the row-stochastic normalization procedure preserves the fundamental identity:

$$
\textbf{F}(\textbf{1} - \textbf{b}) = (\textbf{I} - \textbf{K})\textbf{1}
$$

This identity is the cornerstone of the isotropic formulation's mathematical structure. By maintaining this relationship in the anisotropic case, the row-stochastic normalization ensures that:

- The eigenvalue structure of $\textbf{A} + \textbf{R}$ is preserved
- The nullspace property of $\textbf{C}$ is maintained  
- Energy conservation follows automatically for uniform (or appropriately mixed) boundary conditions

### Comparison with Isotropic Case

| Property | Isotropic | Anisotropic | Status |
|----------|-----------|-------------|--------|
| $\textbf{K}$ structure | Column-constant | Full matrix | Generalized |
| $\textbf{K} \geq 0$ | Trivial | Requires proof | ✓ Proven |
| Key identity | Direct | Via normalization | ✓ Proven |
| Energy conservation | Direct | Via key identity | ✓ Proven |
| Spectral properties | Known | Inherited | ✓ Preserved |

The anisotropic extension represents a true generalization: it maintains all essential properties while accommodating arbitrary directional distributions within the physical constraint $\textbf{\Gamma} \in [0, 1]$.

## Conclusion

The anisotropic exchange factor transformation preserves the mathematical rigor and physical validity of the isotropic formulation. Through careful construction via row-stochastic normalization, the method guarantees:

- **Non-negative radiative quantities** for all physically valid inputs
- **Energy conservation** at steady state
- **Analytical solvability** through matrix inversion
- **Backward compatibility** with the isotropic case

These properties make the anisotropic extension suitable for rigorous scientific computation in radiative transfer applications requiring directional resolution of reflection-scattering processes.