# Anisotropic Extension Analysis {#sec-exchange_fact_anisotropic_extend_analysis}

This chapter establishes the physical correctness of the anisotropic exchange factor transformation by proving that the final interaction-reflection-scattering matrix $\mathbf{K}$ satisfies the fundamental physical bounds: $0 \leq \mathbf{K}_{ij} \leq \mathbf{F}_{ij}$ for all elements. These bounds guarantee non-negativity (no negative probabilities) and energy conservation. It is then proven that the row-stochastic normalization preserves the key algebraic identity that ensures global energy balance.

## Physical Bounds on the Interaction Matrix

The construction of $\mathbf{K}$ through the anisotropic parameterization must satisfy strict element-wise bounds to be physically valid.

::: {.theorem data-title="Physical Bounds on K" #thm-physical-bounds}

For the anisotropic formulation with properly bounded scaling coefficient $c$, the interaction-reflection-scattering matrix $\mathbf{K}$ satisfies:

$$
0 \leq \mathbf{K}_{ij} \leq \mathbf{F}_{ij} \quad \forall \; i,j
$$

:::

The proof proceeds through two lemmas establishing each inequality.

### Lower Bound: Non-Negativity

::: {.lemma data-title="Non-Negativity of K" #lem-k-nonnegative}

For any element $(i,j)$, the constraint $\mathbf{K}_{ij} \geq 0$ is satisfied if:

$$
c \leq \frac{b_j}{\Delta_i(1-b_j) - (2\Gamma_{ij}-1)m_j}
$$

whenever the denominator is positive, where:

- $\Delta_i = \sum_k F_{ik}(2\Gamma_{ik}-1)m_k$
- $m_j = \min(b_j, 1-b_j)$

:::

::: {.proof}

From @eq-k-simplified, it holds that:

$$
\mathbf{K}_{ij} = \frac{\mathbf{K}_{\mathrm{init},ij}}{\mathbf{s}_i} - \mathbf{F}_{ij} \cdot \mathbf{P}_{jj} \left(1 - \frac{1}{\mathbf{s}_i}\right)
$$

Substituting $\mathbf{K}_{\mathrm{init},ij} = \mathbf{F}_{ij} \cdot \mathbf{B}_{\mathrm{init},ij}$ and $\mathbf{P}_{jj} = 1-b_j$:

$$
\mathbf{K}_{ij} = \mathbf{F}_{ij} \left[\frac{\mathbf{B}_{\mathrm{init},ij}}{\mathbf{s}_i} - (1-b_j)\left(1 - \frac{1}{\mathbf{s}_i}\right)\right]
$$

Simplifying:

$$
\mathbf{K}_{ij} = \mathbf{F}_{ij} \cdot \frac{\mathbf{B}_{\mathrm{init},ij} - (\mathbf{s}_i - 1)(1-b_j)}{\mathbf{s}_i}
$$

**Step 1:** For $\mathbf{K}_{ij} \geq 0$ (and $\mathbf{s}_i > 0$), it is necessary that:

$$
\mathbf{B}_{\mathrm{init},ij} \geq (\mathbf{s}_i - 1)(1-b_j)
$$

**Step 2:** Express $\mathbf{s}_i$ from @eq-s-expanded:

$$
\mathbf{s}_i = \sum_k \mathbf{F}_{ik}(\mathbf{B}_{\mathrm{init},ik} + 1 - b_k)
$$

Substituting $\mathbf{B}_{\mathrm{init},ik} = b_k + c(2\Gamma_{ik}-1)m_k$:

$$
\mathbf{s}_i = \sum_k \mathbf{F}_{ik}(b_k + c(2\Gamma_{ik}-1)m_k + 1 - b_k)
$$

$$
\mathbf{s}_i = \sum_k \mathbf{F}_{ik}(1 + c(2\Gamma_{ik}-1)m_k)
$$

Since $\sum_k \mathbf{F}_{ik} = 1$ (row-stochastic):

$$
\mathbf{s}_i = 1 + c\sum_k \mathbf{F}_{ik}(2\Gamma_{ik}-1)m_k = 1 + c\Delta_i
$$

**Step 3:** Substitute back into the constraint:

$$
b_j + c(2\Gamma_{ij}-1)m_j \geq c\Delta_i(1-b_j)
$$

$$
b_j \geq c[\Delta_i(1-b_j) - (2\Gamma_{ij}-1)m_j]
$$

**Step 4:** When the term in brackets is positive:

$$
c \leq \frac{b_j}{\Delta_i(1-b_j) - (2\Gamma_{ij}-1)m_j}
$$

When the term in brackets is non-positive, the constraint is automatically satisfied for any $c \geq 0$. ✓

:::

### Upper Bound: Physical Limit

::: {.lemma data-title="Upper Bound on K" #lem-k-upper}

For any element $(i,j)$, the constraint $\mathbf{K}_{ij} \leq \mathbf{F}_{ij}$ is satisfied if:

$$
c \leq \frac{1-b_j}{(2\Gamma_{ij}-1)m_j - \Delta_i(2-b_j)}
$$

whenever the denominator is positive.

:::

::: {.proof}

**Step 1:** From the expression for $\mathbf{K}_{ij}$, it is necessary that:

$$
\frac{\mathbf{B}_{\mathrm{init},ij} - (\mathbf{s}_i - 1)(1-b_j)}{\mathbf{s}_i} \leq 1
$$

Multiplying by $\mathbf{s}_i > 0$:

$$
\mathbf{B}_{\mathrm{init},ij} - (\mathbf{s}_i - 1)(1-b_j) \leq \mathbf{s}_i
$$

$$
\mathbf{B}_{\mathrm{init},ij} \leq \mathbf{s}_i + (\mathbf{s}_i - 1)(1-b_j)
$$

$$
\mathbf{B}_{\mathrm{init},ij} \leq \mathbf{s}_i[1 + (1-b_j)] - (1-b_j)
$$

$$
\mathbf{B}_{\mathrm{init},ij} \leq \mathbf{s}_i(2-b_j) - (1-b_j)
$$

**Step 2:** Substitute $\mathbf{s}_i = 1 + c\Delta_i$ and $\mathbf{B}_{\mathrm{init},ij} = b_j + c(2\Gamma_{ij}-1)m_j$:

$$
b_j + c(2\Gamma_{ij}-1)m_j \leq (1 + c\Delta_i)(2-b_j) - (1-b_j)
$$

$$
b_j + c(2\Gamma_{ij}-1)m_j \leq (2-b_j) + c\Delta_i(2-b_j) - (1-b_j)
$$

$$
b_j + c(2\Gamma_{ij}-1)m_j \leq 1 + c\Delta_i(2-b_j)
$$

$$
c[(2\Gamma_{ij}-1)m_j - \Delta_i(2-b_j)] \leq 1 - b_j
$$

**Step 3:** When the term in brackets is positive:

$$
c \leq \frac{1-b_j}{(2\Gamma_{ij}-1)m_j - \Delta_i(2-b_j)}
$$

When the term in brackets is non-positive, the constraint is automatically satisfied for any $c \geq 0$. ✓

:::

### Computing the Safe Coefficient

::: {.proof data-title="Proof of Theorem (Physical Bounds)"}

Combining @lem-k-nonnegative and @lem-k-upper, the maximum safe coefficient is:

$$
c_{\max} = \min\left(c_{\max,\text{nonneg}}, c_{\max,\text{leq F}}\right)
$$

where:

$$
c_{\max,\text{nonneg}} = \min_{i,j : \text{denom} > 0} \frac{b_j}{\Delta_i(1-b_j) - (2\Gamma_{ij}-1)m_j}
$$

$$
c_{\max,\text{leq F}} = \min_{i,j : \text{denom} > 0} \frac{1-b_j}{(2\Gamma_{ij}-1)m_j - \Delta_i(2-b_j)}
$$

For numerical safety, use $c = \alpha c_{\max}$ with $\alpha < 1$.

This guarantees $0 \leq \mathbf{K}_{ij} \leq \mathbf{F}_{ij}$ for all elements. ✓

:::

::: {.callout-important}

## Key Properties

1. **Negative B allowed**: $\mathbf{B}_{\mathrm{init},ij}$ can be negative for sufficiently large $c$, but the transformation guarantees $\mathbf{K}_{ij} \geq 0$.

2. **Element-wise freedom**: Full $N \times N$ degrees of freedom in $\mathbf{B}_{\mathrm{init}}$.

3. **Optimal bounds**: Since the bounds on $c$ were derived analytically they provide maximum flexibility for any given $\mathbf{\Gamma}$. 

:::

## Energy Conservation

Having established physical bounds on $\mathbf{K}$, it is now proven that the construction preserves energy conservation through the key algebraic identity.

### Preservation of the Fundamental Identity

::: {.theorem data-title="Key Identity Preservation" #thm-key-identity}

For the anisotropic formulation with row-stochastic normalization, the fundamental identity holds:

$$
\mathbf{F}(\mathbf{1} - \mathbf{b}) = (\mathbf{I} - \mathbf{K})\mathbf{1}
$$

where $\mathbf{b}$ is the vector of reflection-scattering coefficients.

:::

::: {.proof}

**Step 1:** Analyze the row sums of $\mathbf{K}$.

From @eq-k-final and the row-stochastic property of $\mathbf{T}$ (where $\sum_j \mathbf{T}_{ij} = 1$):

$$
\sum_j \mathbf{K}_{ij} = \sum_j \mathbf{T}_{ij} - \sum_j \mathbf{F}_{ij} \cdot \mathbf{P}_{jj}
$$

$$
\sum_j \mathbf{K}_{ij} = 1 - \sum_j \mathbf{F}_{ij} \cdot (1-b_j)
$$

**Step 2:** Express $(\mathbf{I} - \mathbf{K})\mathbf{1}$.

$$
[(\mathbf{I} - \mathbf{K})\mathbf{1}]_i = 1 - \sum_j \mathbf{K}_{ij}
$$

Substituting from Step 1:

$$
[(\mathbf{I} - \mathbf{K})\mathbf{1}]_i = 1 - \left(1 - \sum_j \mathbf{F}_{ij}(1-b_j)\right)
$$

$$
[(\mathbf{I} - \mathbf{K})\mathbf{1}]_i = \sum_j \mathbf{F}_{ij}(1-b_j) = [\mathbf{F}(\mathbf{1}-\mathbf{b})]_i
$$

Therefore: $\mathbf{F}(\mathbf{1} - \mathbf{b}) = (\mathbf{I} - \mathbf{K})\mathbf{1}$ ✓

:::

::: {.callout-important}

## Critical Insight

This theorem is the cornerstone of energy conservation. The row-stochastic normalization ensures that despite the full matrix structure of $\mathbf{B}_{\mathrm{init}}$ (rather than column-constant), the fundamental relationship between $\mathbf{F}$, $\mathbf{K}$, and $\mathbf{b}$ is preserved.

All subsequent eigenvalue properties from the isotropic case carry over directly to the anisotropic case.

:::

### Energy Conservation for Uniform Systems

::: {.theorem data-title="Energy Conservation (Uniform Case)" #thm-energy-conservation}

For a system with uniform reflection-scattering coefficients $\mathbf{b} = b\mathbf{1}$ where $b \in [0,1)$, the system matrix $\mathbf{C}$ satisfies:

$$
\mathbf{1}^T\mathbf{C}\mathbf{j} = 0
$$

for any solution $\mathbf{j}$ of the mixed boundary system $\mathbf{M}\mathbf{j} = \mathbf{h}$.

:::

::: {.proof}

**Step 1:** From @thm-key-identity, left-multiply by $(\mathbf{I}-\mathbf{K})^{-1}$:

$$
(\mathbf{I}-\mathbf{K})^{-1}\mathbf{F}(\mathbf{1}-\mathbf{b}) = \mathbf{1}
$$

Left-multiply by $\mathbf{P} = (1-b)\mathbf{I}$ for uniform $b$:

$$
\mathbf{P}(\mathbf{I}-\mathbf{K})^{-1}\mathbf{F}(\mathbf{1}-\mathbf{b}) = \mathbf{P}\mathbf{1} = (1-b)\mathbf{1}
$$

**Step 2:** The left side equals $\mathbf{A} + \mathbf{R}$ from @eq-a-matrix and @eq-r-matrix:

$$
(\mathbf{A} + \mathbf{R})(\mathbf{1}-\mathbf{b}) = (1-b)\mathbf{1} = (\mathbf{1}-\mathbf{b})
$$

Therefore $(\mathbf{1}-\mathbf{b})$ is an eigenvector of $\mathbf{A}+\mathbf{R}$ with real eigenvalue 1.

**Step 3:** Taking the transpose:

$$
(\mathbf{1}-\mathbf{b})^T(\mathbf{A}^T + \mathbf{R}^T) = (\mathbf{1}-\mathbf{b})^T
$$

$$
(\mathbf{1}-\mathbf{b})^T(\mathbf{I} - \mathbf{A}^T - \mathbf{R}^T) = \mathbf{0}^T
$$

$$
(\mathbf{1}-\mathbf{b})^T\mathbf{C} = \mathbf{0}^T
$$

**Step 4:** For uniform $b$: $(1-b)\mathbf{1}^T\mathbf{C} = \mathbf{0}^T$, and since $(1-b) > 0$:

$$
\mathbf{1}^T\mathbf{C} = \mathbf{0}^T
$$

Therefore: $\mathbf{1}^T\mathbf{C}\mathbf{j} = 0$ ✓

:::

::: {.callout-tip}

## Equivalence to Isotropic Case

This proof is identical to the isotropic case. The only requirement was establishing @thm-key-identity for the anisotropic formulation. Once that identity is proven, energy conservation follows automatically.

This demonstrates the elegance of the row-stochastic normalization: it preserves the fundamental algebraic structure regardless of the complexity of $\mathbf{\Gamma}$.

:::

### Energy Conservation for Mixed Boundary Conditions

::: {.theorem data-title="Energy Conservation (Mixed Boundary Conditions)" #thm-energy-conservation-mixed}

Consider a mixed boundary system $\mathbf{M}\mathbf{j} = \mathbf{h}$ where:

- Rows $I$ of $\mathbf{M}$ are taken from $\mathbf{C}$ with corresponding $\mathbf{h}_I = \mathbf{0}$
- Reflection-scattering coefficients on rows $I$ can be non-uniform: $0 \leq b_i < 1$ for all $i \in I$
- Rows $J$ of $\mathbf{M}$ are taken from $\mathbf{D}$ with corresponding $\mathbf{h}_J \geq \mathbf{0}$
- Reflection-scattering coefficients on rows $J$ are uniform: $b_j = \gamma < 1$ for all $j \in J$

Then the energy conservation property holds:

$$
\mathbf{1}^T\mathbf{C}\mathbf{j} = 0
$$

:::

::: {.proof}

From @thm-energy-conservation, it holds that $(\mathbf{1}-\mathbf{b})^T\mathbf{C} = \mathbf{0}^T$.

Partition the system by rows $I$ (known sources) and $J$ (known emissive powers):

$$
\mathbf{1}^T\mathbf{C}\mathbf{j} = \mathbf{1}^T\mathbf{C}_I\mathbf{j} + \mathbf{1}^T\mathbf{C}_J\mathbf{j}
$$

**Part 1:** For rows $I$ with $\mathbf{C}_I\mathbf{j} = \mathbf{0}$:

$$
\mathbf{1}^T\mathbf{C}_I\mathbf{j} = \mathbf{1}^T\mathbf{0} = 0
$$

**Part 2:** For rows $J$ with uniform $b_j = \gamma$:

From $(\mathbf{1}-\mathbf{b})^T\mathbf{C} = \mathbf{0}^T$, considering only rows $J$:

$$
(\mathbf{1}-\gamma\mathbf{1})^T\mathbf{C}_J\mathbf{j} = (1-\gamma)\mathbf{1}^T\mathbf{C}_J\mathbf{j} = 0
$$

Since $(1-\gamma) > 0$:

$$
\mathbf{1}^T\mathbf{C}_J\mathbf{j} = 0
$$

**Conclusion:** Combining both parts:

$$
\mathbf{1}^T\mathbf{C}\mathbf{j} = 0 + 0 = 0
$$

Energy conservation holds for mixed boundary conditions. ✓

:::

## Summary

The anisotropic extension preserves all essential physical properties:

| Property | Requirement | Status |
|----------|-------------|--------|
| $\mathbf{K} \geq 0$ | Non-negativity | ✓ @thm-physical-bounds |
| $\mathbf{K} \leq \mathbf{F}$ | Physical bound | ✓ @thm-physical-bounds |
| Key identity | Algebraic structure | ✓ @thm-key-identity |
| Energy conservation (uniform) | Global balance | ✓ @thm-energy-conservation |
| Energy conservation (mixed) | General case | ✓ @thm-energy-conservation-mixed |

The method provides:

- **Maximum flexibility**: Element-wise control with optimal bounds on $c$
- **Physical validity**: Guaranteed through proper coefficient selection
- **Energy conservation**: Automatic for uniform and mixed boundary conditions
- **Computational efficiency**: Analytical solution via matrix inversion

The anisotropic formulation represents a true generalization that maintains mathematical rigor while accommodating arbitrary directional distributions within the physical constraint $0 \leq \mathbf{\Gamma}_{ij} \leq 1$.